<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="è®°å½•ä¸€æ¬¡è§†é¢‘ç›‘æ§åœºæ™¯ä¸‹å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ€§èƒ½æµ‹è¯•åŠç®€å•è°ƒä¼˜çš„è¿‡ç¨‹åŠæ€è·¯ï¼Œç›¸å…³å†…å®¹å·²è„±æ•\n1 æ€§èƒ½åˆ†ææ–¹æ³• å¯é€šè¿‡æ—¥å¿—å’Œæ£€æµ‹å·¥å…·æ¥ç›‘æ§åŸºäºfuseå®ç°çš„ç”¨æˆ·æ€æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½\n"><title>è®°ä¸€æ¬¡æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½æµ‹è¯•</title><link rel=canonical href=https://morsuning.github.io/p/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/><link rel=stylesheet href=/scss/style.min.833d6eed45de56f48306bf57268d5b8cdfc8a60e8e7bdc99810464fcd033f7c6.css><meta property='og:title' content="è®°ä¸€æ¬¡æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½æµ‹è¯•"><meta property='og:description' content="è®°å½•ä¸€æ¬¡è§†é¢‘ç›‘æ§åœºæ™¯ä¸‹å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ€§èƒ½æµ‹è¯•åŠç®€å•è°ƒä¼˜çš„è¿‡ç¨‹åŠæ€è·¯ï¼Œç›¸å…³å†…å®¹å·²è„±æ•\n1 æ€§èƒ½åˆ†ææ–¹æ³• å¯é€šè¿‡æ—¥å¿—å’Œæ£€æµ‹å·¥å…·æ¥ç›‘æ§åŸºäºfuseå®ç°çš„ç”¨æˆ·æ€æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½\n"><meta property='og:url' content='https://morsuning.github.io/p/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/'><meta property='og:site_name' content="morsuning's Blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Storage'><meta property='article:published_time' content='2023-11-27T00:00:00+00:00'><meta property='article:modified_time' content='2023-11-27T00:00:00+00:00'><meta name=twitter:title content="è®°ä¸€æ¬¡æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½æµ‹è¯•"><meta name=twitter:description content="è®°å½•ä¸€æ¬¡è§†é¢‘ç›‘æ§åœºæ™¯ä¸‹å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ€§èƒ½æµ‹è¯•åŠç®€å•è°ƒä¼˜çš„è¿‡ç¨‹åŠæ€è·¯ï¼Œç›¸å…³å†…å®¹å·²è„±æ•\n1 æ€§èƒ½åˆ†ææ–¹æ³• å¯é€šè¿‡æ—¥å¿—å’Œæ£€æµ‹å·¥å…·æ¥ç›‘æ§åŸºäºfuseå®ç°çš„ç”¨æˆ·æ€æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_40bcc3d697d2dcd2.png width=300 height=225 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸŒŸ</span></figure><div class=site-meta><h1 class=site-name><a href=/>morsuning's Blog</a></h1><h2 class=site-description>Developer. Geeker. e/acc. Investing in the future.</h2></div></header><ol class=menu-social><li><a href=https://github.com/morsuning target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/morsuning target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#1-æ€§èƒ½åˆ†ææ–¹æ³•>1 æ€§èƒ½åˆ†ææ–¹æ³•</a></li><li><a href=#2-æ€§èƒ½åˆ†ææ€è·¯>2 æ€§èƒ½åˆ†ææ€è·¯</a></li><li><a href=#3-æ€§èƒ½åˆ†æç¯å¢ƒé…ç½®åŠæ“ä½œ>3 æ€§èƒ½åˆ†æç¯å¢ƒé…ç½®åŠæ“ä½œ</a><ol><li><a href=#31-æµ‹è¯•ç¯å¢ƒ>3.1 æµ‹è¯•ç¯å¢ƒ</a></li><li><a href=#32-æµ‹è¯•é…ç½®>3.2 æµ‹è¯•é…ç½®</a></li><li><a href=#33-æµ‹è¯•æ“ä½œ>3.3 æµ‹è¯•æ“ä½œ</a></li></ol></li><li><a href=#4-æµ‹è¯•ä¸­äº§ç”Ÿçš„éƒ¨åˆ†æ•°æ®>4 æµ‹è¯•ä¸­äº§ç”Ÿçš„éƒ¨åˆ†æ•°æ®</a></li><li><a href=#5-æµ‹è¯•ç»“æœåˆ†æ>5 æµ‹è¯•ç»“æœåˆ†æ</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/share/>Share</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/>è®°ä¸€æ¬¡æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½æµ‹è¯•</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2023-11-27T00:00:00Z>Nov 27, 2023</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 5 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><p>è®°å½•ä¸€æ¬¡è§†é¢‘ç›‘æ§åœºæ™¯ä¸‹å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ€§èƒ½æµ‹è¯•åŠç®€å•è°ƒä¼˜çš„è¿‡ç¨‹åŠæ€è·¯ï¼Œç›¸å…³å†…å®¹å·²è„±æ•</p><h2 id=1-æ€§èƒ½åˆ†ææ–¹æ³•>1 æ€§èƒ½åˆ†ææ–¹æ³•</h2><p>å¯é€šè¿‡æ—¥å¿—å’Œæ£€æµ‹å·¥å…·æ¥ç›‘æ§åŸºäºfuseå®ç°çš„ç”¨æˆ·æ€æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½</p><p>ä»¥JuiceFSä¸ºä¾‹ï¼Œå®ƒæä¾›äº†è®¿é—®æ—¥å¿—å’Œæ€§èƒ½æ—¥å¿—ä»¥åŠå‘½ä»¤è¡Œå·¥å…·ç›‘æ§æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½ï¼Œä½¿ç”¨æ–¹å¼åˆ†åˆ«å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ cat /path/to/your/.accesslog
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat /path/to/your/.perfmetric
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ juicefs stats /path/to/your
</span></span></code></pre></td></tr></table></div></div><h2 id=2-æ€§èƒ½åˆ†ææ€è·¯>2 æ€§èƒ½åˆ†ææ€è·¯</h2><p>åœ¨è§†é¢‘ç›‘æ§åœºæ™¯ä¸‹ï¼Œæ–‡ä»¶ä¸ºå¤šè·¯ç›‘æºè¿ç»­è¿½åŠ å†™å…¥æ–‡ä»¶ç³»ç»Ÿ</p><p>å‡è®¾ç½‘ç»œæ— ç“¶é¢ˆï¼Œæ–‡ä»¶ç³»ç»Ÿå†…æ‰€æœ‰å­˜å‚¨ä»‹è´¨å†™å…¥é€Ÿç‡ä¸€è‡´ï¼Œç†æƒ³æƒ…å†µä¸‹æœ€å¤§å¸¦å®½ï¼š</p><ul><li>å•èŠ‚ç‚¹ï¼šæœåŠ¡ç«¯ä»æœ¬åœ°å†™å…¥JuiceFSé€Ÿåº¦ä¸ºè¯¥èŠ‚ç‚¹çš„æœ€å¤§å†™å…¥é€Ÿåº¦</li><li>3èŠ‚ç‚¹ï¼šæœŸæœ›æœ€å¤§å†™å…¥é€Ÿåº¦ä¸ºå•èŠ‚ç‚¹æœ€å¤§å†™å…¥é€Ÿåº¦ * 3</li></ul><p>æµ‹è¯•å¾—æœåŠ¡ç«¯å•èŠ‚ç‚¹ä»æœ¬åœ°å†™å…¥JuiceFSé€Ÿåº¦å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>fiotest: (g=0):rw=write,bs=(R)16.0MiB-16.0MiB, (W) 16.0MiB-16.0MiB, (T) 16.0MiB-16.0MiB,ioengine=libaio, iodepth=1
</span></span><span class=line><span class=cl>fio-3.29
</span></span><span class=line><span class=cl>Starting 1 process
</span></span><span class=line><span class=cl>fiotest: Laying out I0 file (1 file / 4096MiB)
</span></span><span class=line><span class=cl>Jobs: 1 (f=1): [W(1)][100.0%][w=256MiB/s][w=16 IOPS][eta 00m:00s]
</span></span><span class=line><span class=cl>fiotest: (groupid=0, jobs=1): err= 0: pid=528243: Sun Nov 26 02:26:37 2023
</span></span><span class=line><span class=cl>write: IOPS=16, BW=257MiB/s (269MB/s)(4096MiB/15937msec); 0 zone resets
</span></span><span class=line><span class=cl>slat (usec): min=8557, max=18135, avg=9782.97, stdev=718.53
</span></span><span class=line><span class=cl>clat (nsec) : min=2590, max=19341, avg=6322.75, stdev=2224.38
</span></span><span class=line><span class=cl>lat (usec): min=8560, max=18145, avg=9791.82, stdev=719.24
</span></span><span class=line><span class=cl>clat percentiles (nsec):
</span></span><span class=line><span class=cl>1.00th=[ 2928].
</span></span><span class=line><span class=cl>5.00th=[ 3376], 10.00th=[ 3856], 20.00th=[ 4448],
</span></span><span class=line><span class=cl>30.00th=[ 5152],
</span></span><span class=line><span class=cl>40.00th=[ 5728], 50.00th=[ 6176], 60.00th=[ 6624],
</span></span><span class=line><span class=cl>70.00th=[ 7264], 80.00th=[ 7776],
</span></span><span class=line><span class=cl>90.00th=[ 8512], 95.00th=[ 8896],
</span></span><span class=line><span class=cl>99.00th=[15936],
</span></span><span class=line><span class=cl>99.50th=[18560], 99.90th=[19328], 99.95th=[19328],
</span></span><span class=line><span class=cl>99.99th=[19328]
</span></span><span class=line><span class=cl>bw ( KiB/s) : min=229376, max=294912, per=100.00%, avg=263201.03, stdev=15791.93, samples=31
</span></span><span class=line><span class=cl>iops: min= 14, max= 18, avg=16.06, stdev= 0.96, samples=31
</span></span><span class=line><span class=cl>lat (usec)
</span></span><span class=line><span class=cl>: 4=11.33%, 10=85.16%, 20=3.52%
</span></span><span class=line><span class=cl>fsync/fdatasync/sync_file_range:
</span></span><span class=line><span class=cl>sync (nsec) : min=220, max=2550, avg=1182.90, stdev=474.05
</span></span><span class=line><span class=cl>sync percentiles (nsec):
</span></span><span class=line><span class=cl>1.00th[3301],
</span></span><span class=line><span class=cl>5.00th[410], 10.00th[524], 20.00th[700],
</span></span><span class=line><span class=cl>30.00th[900], 40.00th[1064], 50.00th[1176],
</span></span><span class=line><span class=cl>60.00th[1336], 70. 00th[1432],
</span></span><span class=line><span class=cl>80.00th[1608], 90.00th[1848], 95.00th[2008],
</span></span><span class=line><span class=cl>99.00th[2192],
</span></span><span class=line><span class=cl>99.50th[2352], 99.90th[2544], 99.95th[2544],
</span></span><span class=line><span class=cl>99.99th[2544]
</span></span><span class=line><span class=cl>cpu
</span></span><span class=line><span class=cl>usr=1.26%, sys=0.51%, ctx=4608, majf=0, minf=11
</span></span><span class=line><span class=cl>IO depths
</span></span><span class=line><span class=cl>: 1=199.6%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;64=0.0%
</span></span><span class=line><span class=cl>submit
</span></span><span class=line><span class=cl>: 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;64=0.0%
</span></span><span class=line><span class=cl>complete
</span></span><span class=line><span class=cl>: 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;64=0.0%
</span></span><span class=line><span class=cl>issued rwts: total=0, 256, 0, 255 short=0, 0, 0, 0 dropped=0, 0, 0, 0
</span></span><span class=line><span class=cl>latency
</span></span><span class=line><span class=cl>: target=0, window=0, percentile=100.00%, depth=1
</span></span><span class=line><span class=cl>Run status group 0 (all jobs):
</span></span><span class=line><span class=cl>WRITE: bw=257MiB/s (269MB/s), 257MiB/s-257MiB/s (269MB/s-269MB/s), io=4096MiB (4295MB), run=15937-15937msec
</span></span></code></pre></td></tr></table></div></div><p><strong>ioè·¯å¾„åˆ†æ</strong></p><p>nfs â†’ é€šè¿‡å‰ç«¯ç½‘ç»œ â†’ JuiceFS â†’ é€šè¿‡åç«¯ç½‘ç»œ â†’ åˆ†å¸ƒå¼æŒä¹…å±‚ â†’ ç£ç›˜</p><p>nfså‘JuiceFSå¹¶å‘å‘é€ioè¯·æ±‚ï¼ŒJuiceFSå°†æ”¶åˆ°çš„æ•°æ®æš‚å†™å…¥ç¼“å­˜ï¼Œè¾¾åˆ°æŒ‡å®šå¤§å°åå†™ç¼“å­˜åˆ†å¸ƒå¼æŒä¹…å±‚ï¼Œåˆ†å¸ƒå¼æŒä¹…å±‚è¿”å›åè¯¥æ¬¡è½ç›˜æ“ä½œæ‰ç®—æˆåŠŸ</p><p>å› æ­¤ä¸Šè¿°è¿‡ç¨‹ä¸­å­˜åœ¨2ä¸ªæ—¶å»¶ï¼Œç¬¬ä¸€ä¸ªæ—¶å»¶ä¸ºJuiceFSç­‰å¾…ioè¯·æ±‚ï¼Œç›´åˆ°ioè¯·æ±‚è¾¾åˆ°æŒ‡å®šå¤§å°ï¼›ç¬¬äºŒä¸ªæ—¶å»¶ä¸ºJuiceFSç­‰å¾…åˆ†å¸ƒå¼æŒä¹…å±‚è¿”å›</p><p>ç†è®ºä¸Šè¿™ä¸¤ä¸ªæ—¶å»¶æ—¶é—´ä¸€è‡´ä¸”å‘¨æœŸä¸€è‡´ï¼Œæ€§èƒ½æœ€ä¼˜</p><h2 id=3-æ€§èƒ½åˆ†æç¯å¢ƒé…ç½®åŠæ“ä½œ>3 æ€§èƒ½åˆ†æç¯å¢ƒé…ç½®åŠæ“ä½œ</h2><h3 id=31-æµ‹è¯•ç¯å¢ƒ>3.1 æµ‹è¯•ç¯å¢ƒ</h3><ul><li>æœåŠ¡ç«¯é…ç½®ï¼šæ›™å…‰Rack/R6440H0 * 3; 2U 32Core; RAM 128G</li><li>ç½‘ç»œï¼šfioå’Œmdtestæµ‹è¯•ï¼š3æœåŠ¡ç«¯ï¼Œ1å®¢æˆ·ç«¯ï¼Œå‡ç»„bond6_frontï¼Œç½‘ç»œæœ€å¤§å¸¦å®½20G/s</li></ul><h3 id=32-æµ‹è¯•é…ç½®>3.2 æµ‹è¯•é…ç½®</h3><p>é¦–å…ˆJuiceFSåœ¨å—å¤§å° >= 16mæ—¶ä¼šç›´æ¥å°†æ•°æ®å†™å¯¹è±¡ï¼Œå› æ­¤æµ‹è¯•å—å¤§å°16Mçš„æ–‡ä»¶å†™å…¥æ—¶éœ€è¦è°ƒå¤§å†™å¯¹è±¡å—å¤§å°ä¸Šé™ï¼ŒåŒæ—¶æ‰“å¼€æ–‡ä»¶å…ƒæ•°æ®ç¼“å­˜å’Œç›®å½•é¡¹ç¼“å­˜è¶…æ—¶æ—¶é—´æ¥æé«˜è¿ç»­å†™å…¥æ•ˆç‡</p><p>éœ€ä¿®æ”¹çš„é…ç½®</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>juicefs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cacheDir</span><span class=p>:</span><span class=w> </span><span class=l>/var/powercache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>uploadDelay</span><span class=p>:</span><span class=w> </span><span class=l>10m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>trashDays</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logDir</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/var/log/juicefs&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>xxxClientPackagePath</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/opt/xxx/xxx_client.tar&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>xxxClientPort</span><span class=p>:</span><span class=w> </span><span class=m>33999</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>backupMeta</span><span class=p>:</span><span class=w> </span><span class=l>24h</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>attr-cache</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w> </span><span class=c># ä¿®æ”¹é¡¹</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>entry-cache</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w> </span><span class=c># ä¿®æ”¹é¡¹</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dir-entry-cache</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w> </span><span class=c># ä¿®æ”¹é¡¹</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespaceRootDir</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/xxx&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>disable-lock</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>cache-type</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>free-ratio-raw</span><span class=p>:</span><span class=w> </span><span class=m>0.15</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>free-ratio-staging</span><span class=p>:</span><span class=w> </span><span class=m>0.10</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extendedParams </span><span class=p>:</span><span class=w> </span><span class=s2>&#34;--upload-block-size 32 max-uploads 32 --flush-by-no-write 100&#34;</span><span class=w> </span><span class=c># ä¿®æ”¹é¡¹</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>bucketName</span><span class=p>:</span><span class=w> </span><span class=l>xxx-03e89688</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>æµ‹è¯•å‰å‡†å¤‡</p><ol><li>åœ¨æœåŠ¡ç«¯viewä¸Šå…±äº«1ä¸ªNFSæ–‡ä»¶å¤¹nfstest</li><li>åœ¨å®¢æˆ·ç«¯æŒ‚è½½è¯¥ç›®å½•: <code>mount -t nfs -o vers=3 ä¸šåŠ¡ç½‘:/xxx/nfstest /mnt/nfstest</code></li><li>åœ¨å®¢æˆ·ç«¯æ‰§è¡Œfioå’Œmdtestè¿›è¡Œæµ‹è¯•</li></ol><h3 id=33-æµ‹è¯•æ“ä½œ>3.3 æµ‹è¯•æ“ä½œ</h3><ol><li>æ‰§è¡Œcpå¤åˆ¶3.5Gæ–‡ä»¶ç»“æœ</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@node1<span class=o>]</span><span class=c1># time cp openEuler-22.03-LTS-SP1-x86_64-dvd.iso /mnt/nfstest/testos</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>real 0m8.210s</li><li>user 0m0.000s</li><li>sys 0m2.236s</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>root@node1<span class=o>]</span><span class=c1># ls -1lh openEuler-22.03-LTS-SP1-x86_64-dvd.iso</span>
</span></span></code></pre></td></tr></table></div></div><p>root root 3.5G Nov 25 09:58 openEuler-22.03-LTS-SP1-x86_64-dvd.iso</p><ol start=2><li><p>æ‰§è¡Œ2ä¸ªfioæµ‹è¯•ï¼Œå‚æ•°åŠç»“æœå¦‚ä¸‹</p><p>(1)4Kéšæœºå†™å…¥:</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>fio -directory<span class=o>=</span>/mnt/nfstest/test1 -ioengine<span class=o>=</span>libaio -iodepth<span class=o>=</span><span class=m>1</span> -direct<span class=o>=</span><span class=m>1</span> -fsync<span class=o>=</span><span class=m>1</span> -bs<span class=o>=</span>4K -flesize<span class=o>=</span>8M --rw<span class=o>=</span>write -numjobs<span class=o>=</span><span class=m>56</span> -name<span class=o>=</span>fiotest -group_reporting -output<span class=o>=</span>4k_randw.data
</span></span></code></pre></td></tr></table></div></div><p>ç»“æœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>fiotest: (groupid=0, jobs=56): err= 0: pid=1668325: Sat Nov 25 16:48:17 2023
</span></span><span class=line><span class=cl>write: I0PS=2444, BW=9778KiB/s (10.0MB/s)(448MiB/46919msec); 0 zone resets
</span></span><span class=line><span class=cl>slat (nsec): min=1551, max=q7180, avg=3033.72, stdev=2019.74
</span></span><span class=line><span class=cl>clat (msec): min=6, max=438, avg=21.69, stdev=22.42
</span></span><span class=line><span class=cl>Lat (msec): min=6, max=438, avg=21.70, stdev=22.42
</span></span><span class=line><span class=cl>clat percentiles (msec):
</span></span><span class=line><span class=cl>1 1.00th=[q], 5.00th=[11], 10.00th=[12], 20.00th=[13],
</span></span><span class=line><span class=cl>30.00th=[15], 40.00th=[16], 50.00th=[18], 60.00th=[20],
</span></span><span class=line><span class=cl>70.00th=[22], 80.00th=[25], 90.00th=[34], 95.00th=[42],
</span></span><span class=line><span class=cl>99.00th=[79], 99.50th=[220], 99.90th=[239], 99.95th=[251],
</span></span><span class=line><span class=cl>99.99th=[430]
</span></span><span class=line><span class=cl>bw ( KiB/s): 
</span></span><span class=line><span class=cl>min= 1752, max=19184, per=100.00%, avg=10366.19, stdev=53.86,
</span></span><span class=line><span class=cl>samples=4947
</span></span><span class=line><span class=cl>iops
</span></span><span class=line><span class=cl>: 
</span></span><span class=line><span class=cl>min= 438, max= 4796, avg=2591.49, stdev=13.46, samples=4947
</span></span><span class=line><span class=cl>lat (msec)
</span></span><span class=line><span class=cl>: 10=4.31%ï¼Œ20=60.64%ï¼Œ50=32.90%ï¼Œ100=1.18%ï¼Œ250=0.90%
</span></span><span class=line><span class=cl>lat (msec)
</span></span><span class=line><span class=cl>: 500=0.05%
</span></span><span class=line><span class=cl>fsync/fdatasync/sync_file_range:
</span></span><span class=line><span class=cl>sync (nsec): min=16, max=4702, avg=40.81, stdev=30.54
</span></span><span class=line><span class=cl>sync percentiles (nsec):
</span></span><span class=line><span class=cl>1.00th=[22]ï¼Œ 5.00th=[23], 10.00th=[26], 20.00th=[32],
</span></span><span class=line><span class=cl>30.00th=[33], 40.00th=[34], 50.00th=[34], 60.00th=[39]
</span></span><span class=line><span class=cl>70.00th=[43],80.00th=[47], 90.00th=[54], 95.00th=[64],
</span></span><span class=line><span class=cl>99.00th=[145], 99.50th=[151], 99.90th=[193]ï¼Œ99.95th=[338],
</span></span><span class=line><span class=cl>99.99th=[532]
</span></span><span class=line><span class=cl>cpu
</span></span><span class=line><span class=cl>: usr=0.01%, sys=0.03%, ctx=114944, majf=0, minf=56
</span></span><span class=line><span class=cl>I0 depths 
</span></span><span class=line><span class=cl>: 1=200.0%, 2=0.0%, 4=0.0%, 8=0.0%, 16=0.0%, 32=0.0%, &gt;=64=0.0%
</span></span><span class=line><span class=cl>submit
</span></span><span class=line><span class=cl>: 0=0.0%ï¼Œ 4=100.0%ï¼Œ 8=0.0%ï¼Œ 16=0.0%ï¼Œ 32=0.0%ï¼Œ 64=0.0%ï¼Œ &gt;=64=0.0%
</span></span><span class=line><span class=cl>complete : 0=0.0%ï¼Œ 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, &gt;=64=0.0%
</span></span><span class=line><span class=cl>issued rwts: total=0,114688,0,114632 short=0,0,0,0 dropped=0,0,0,0
</span></span><span class=line><span class=cl>Latency
</span></span><span class=line><span class=cl> : target=0, window=0, percentile=100.00%, depth=1
</span></span><span class=line><span class=cl>Run status group 0 (all jobs):
</span></span><span class=line><span class=cl>WRITE: bw=9778KiB/s (10.0MB/s), 9778KiB/s-9778KiB/s (10.0MB/s-10.0MB/s), io=448MiB (470MB), run=46919-46919msec
</span></span></code></pre></td></tr></table></div></div><p>(2)16Må¤§æ–‡ä»¶è¿ç»­å†™å…¥ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>fio -directory<span class=o>=</span>/mnt/nfstest/test2 -ioengine<span class=o>=</span>libaio -iodepth<span class=o>=</span><span class=m>1</span> -direct<span class=o>=</span><span class=m>1</span> -fsync<span class=o>=</span><span class=m>1</span> -bs<span class=o>=</span>16M -filesize<span class=o>=</span>1G --rw<span class=o>=</span>write -numjobs<span class=o>=</span><span class=m>16</span> -name<span class=o>=</span>fiotest -group_reporting -output<span class=o>=</span>16_w.data
</span></span></code></pre></td></tr></table></div></div><p>ç»“æœ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>fiotest2: (groupid=0, jobs=16): err= 0: pid=166q561: Sat Nov 25 16:49:02 2023
</span></span><span class=line><span class=cl>write: I0PS=38, BW=608MiB/s (638MB/s)(16.0GiB/26934msec); 0 zone resets
</span></span><span class=line><span class=cl>slat (usec): min=1144, max=3439, avg=1612.21, stdev=208.03
</span></span><span class=line><span class=cl>clat (msec): min=142, max=643, avg=414.0q, stdev=41.20
</span></span><span class=line><span class=cl>lat (msec): min=144, max=644, avg=415.70, stdev=41.15
</span></span><span class=line><span class=cl>clat percentiles (msec):
</span></span><span class=line><span class=cl> 1.00th=[284]ï¼Œ 5.00th=[355], 10.00th=[368], 20.00th=[384], 
</span></span><span class=line><span class=cl> 30.00th=[397], 40.00th=[409], 50.00th=[418], 60.00th=[426],
</span></span><span class=line><span class=cl> 70.00th=[439], 80.00th=[447], 90.00th=[460], 95.00th=[468],
</span></span><span class=line><span class=cl> 99.00th=[489], 99.50th=[502], 99.90th=[542], 99.95th=[642],
</span></span><span class=line><span class=cl> 99.99th=[642]
</span></span><span class=line><span class=cl>bw ( KiB/s): min=523436, max=1048576, per=100.00%, avg=624827.94, stdev=12902.57, samples=845
</span></span><span class=line><span class=cl>iops:
</span></span><span class=line><span class=cl>min=25ï¼Œmax=64, avg=38.00, stdev=0.80, samples=845
</span></span><span class=line><span class=cl>lat (msec)
</span></span><span class=line><span class=cl>: 250=0.68%ï¼Œ500=98.83%, 750=0.49%
</span></span><span class=line><span class=cl>fsync/fdatasync/sync_file_range:
</span></span><span class=line><span class=cl>sync (nsec): min=16, max=604, avg=159.23, stdev=85.32
</span></span><span class=line><span class=cl>sync percentiles (nsec):
</span></span><span class=line><span class=cl> 1.00th=[35]ï¼Œ 5.00th=[56], 10.00th=[70], 20.00th=[129] ,
</span></span><span class=line><span class=cl> 30.00th=[139], 40.00th=[147], 50.00th=[151], 60.00th=[157] ,
</span></span><span class=line><span class=cl> 70.00th=[161], 80.00th=[169], 90.00th=[191], 95.00th=[342],
</span></span><span class=line><span class=cl> 99.00th=[540], 99.50th=[580], 99.90th=[604], 99.95th=[604],
</span></span><span class=line><span class=cl> 99.99th=[604]
</span></span><span class=line><span class=cl>cpu
</span></span><span class=line><span class=cl>usr=0.17%, sys=0.21%, ctx=1082, majf=0, minf=16
</span></span><span class=line><span class=cl>I0 depths 
</span></span><span class=line><span class=cl>: 1=198.4%ï¼Œ 2=0.0%ï¼Œ 4=0.0%ï¼Œ 8=0.0%ï¼Œ 16=0.0%ï¼Œ 32=0.0%ï¼Œ &gt;=64=0.0%
</span></span><span class=line><span class=cl>submit
</span></span><span class=line><span class=cl>ï¼š 0=0.0%ï¼Œ 4=100.0%ï¼Œ 8=0.0%ï¼Œ 16=0.0%ï¼Œ 32=0.0%ï¼Œ 64=0.0%ï¼Œ &gt;=64=0.0%
</span></span><span class=line><span class=cl>complete
</span></span><span class=line><span class=cl>: 0=0.0%ï¼Œ 4=100.0%ï¼Œ 8=0.0%ï¼Œ 16=0.0%ï¼Œ 32=0.0%ï¼Œ 64=0.0%ï¼Œ &gt;=64=0.0%
</span></span><span class=line><span class=cl>issued rwts: total=0,1024,0,1008 short=0,0,0,0 dropped=0,0,0,0
</span></span><span class=line><span class=cl>Latency
</span></span><span class=line><span class=cl> : target=0, window=0, percentile=100.00%, depth=1
</span></span><span class=line><span class=cl>Run status group 0 (all jobs):
</span></span><span class=line><span class=cl>WRITE: bw=608MiB/s (638MB/s), 608MiB/s-608MiB/s (638MB/s-638MB/s)ï¼Œ io=16.0GiB (17.2GB), run=26934-26934msec
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>æ‰§è¡Œ3æ¬¡mtestå…ƒæ•°æ®æµ‹è¯•<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ mpirun --allow-run-as-root localhost:64 -np <span class=m>64</span> mdtest -I <span class=m>20</span> -z <span class=m>2</span> -b <span class=m>10</span> -w <span class=m>131072</span> -e <span class=m>131072</span> -d /mnt/nfstest/perf1 -t -u
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ mpirun --allow-run-as-root localhost:56 -np <span class=m>56</span> mdtest -I <span class=m>50</span> -z <span class=m>2</span> -b <span class=m>10</span> -w <span class=m>524288</span> -e <span class=m>524288</span> -d /mnt/nfstest/perf2 -t -u
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ mpirun --allow-run-as-root localhost:32 -np <span class=m>32</span> mdtest -I <span class=m>20</span> -z <span class=m>2</span> -b <span class=m>10</span> -w <span class=m>1048576</span> -e <span class=m>1048576</span> -d /mnt/nfstest/perf3 -t -u
</span></span></code></pre></td></tr></table></div></div></li></ol><p>ç»“æœç•¥</p><h2 id=4-æµ‹è¯•ä¸­äº§ç”Ÿçš„éƒ¨åˆ†æ•°æ®>4 æµ‹è¯•ä¸­äº§ç”Ÿçš„éƒ¨åˆ†æ•°æ®</h2><p>iostat - æ¯å—ç£ç›˜IOæƒ…å†µ</p><p>mpstat - ç³»ç»ŸCPUèµ„æºå ç”¨æƒ…å†µ</p><p>juicefs stat - JuiceFSå®æ—¶æ€§èƒ½æŒ‡æ ‡</p><p>juicefs .perfmetric - JuiceFSå•ä½æ—¶é—´å†…IOæƒ…å†µ</p><p>juicefs .accesslog - JuiceFSè®¿é—®æ—¥å¿—</p><p>å…·ä½“æ•°æ®ç•¥</p><h2 id=5-æµ‹è¯•ç»“æœåˆ†æ>5 æµ‹è¯•ç»“æœåˆ†æ</h2><p>è§‚å¯Ÿåˆ°2ä¸ªé—®é¢˜</p><ol><li>ä»perfmetricçœ‹å‡ºï¼Œæ¯æ¬¡JuiceFSå†™åˆ†å¸ƒå¼æŒä¹…å±‚å¤§å°(write_cache)ä¸å‡ï¼Œç†è®ºåº”è¯¥æ˜¯ç»Ÿä¸€å¤§å°</li><li>ä»accesslogçœ‹å‡ºï¼Œåˆ·æ–°æ—¶é—´ä¸å‡è¡¡ï¼Œè¿ç»­å†™æ–‡ä»¶ç†è®ºä¸Šé—´éš”åº”è¯¥ç»Ÿä¸€</li></ol><p>é’ˆå¯¹é—®é¢˜1ï¼Œæ¨æµ‹å¯èƒ½æ˜¯NFSé—®é¢˜ï¼Œå°è¯•åœ¨æœåŠ¡å™¨æœ¬åœ°å†™JuiceFSï¼Œè§‚å¯Ÿperfmetricæ—¥å¿—ï¼Œå‘ç°å†™å…¥å¤§å°ä¸€è‡´ï¼Œè¯æ˜æ¨æµ‹æˆç«‹ï¼Œæ˜¯NFSå®¢æˆ·ç«¯å•ä½æ—¶é—´å†…å‘å‡ºçš„IOå¤§å°ä¸ä¸€è‡´å¯¼è‡´</p><p>é’ˆå¯¹é—®é¢˜2ï¼Œæ¨æµ‹æœ‰å…¶ä»–æœºåˆ¶è§¦å‘åˆ·æ–°ï¼Œå°†å¼ºåˆ¶åˆ·æ–°æ—¶é—´æ›´æ”¹ä¸º100sï¼Œå†æ¬¡å†™å…¥æ•°æ®æŸ¥çœ‹accesslogï¼Œå‘ç°è¿˜æ˜¯æœ‰ä¸å‡åŒ€çš„åˆ·æ–°ï¼Œæ”¯æŒæ¨æµ‹æˆç«‹</p></section><footer class=article-footer><section class=article-tags><a href=/tags/storage/>Storage</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/%E8%AE%B0%E4%B8%80%E6%AC%A1cpu%E5%8D%A0%E7%94%A8%E8%BF%87%E9%AB%98%E9%97%AE%E9%A2%98%E5%AE%9A%E4%BD%8D/><div class=article-details><h2 class=article-title>è®°ä¸€æ¬¡CPUå ç”¨è¿‡é«˜é—®é¢˜å®šä½</h2></div></a></article><article><a href=/p/macos-%E5%BC%80%E5%8F%91%E8%BD%AF%E4%BB%B6%E5%8F%8A-shell-%E9%85%8D%E7%BD%AE%E6%8E%A8%E8%8D%90/><div class=article-details><h2 class=article-title>MacOS å¼€å‘è½¯ä»¶åŠ Shell é…ç½®æ¨è</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//morsuning.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2018 -
2026 morsuning's Blog</section><section class=powerby>Intelligence all rights reserved.<br>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>